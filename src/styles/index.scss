@use 'sass:color';

// -----------------------------------------------------------------------------
// Global Variables
// -----------------------------------------------------------------------------

// Layout
$container-height: calc(100vh - 100px);

// Colors
$color-warning-bg: #fff8e1;
$color-warning-border: #f4c030;
$color-warning-text: #5c4c00;
$color-control-text: #6d7f8b;
$color-control-hover-bg: #d1d5d9;
$color-separator: #dee6eb;
$color-secondary-text: #666666;
$color-panel-title: #6d7f8b;
$color-selection: #3872e0cc; // rgba(56, 114, 224, 0.8) as hex with alpha
$color-white: #ffffff;
$color-as-icon-bg: #8fa4b1;

// ArgoCD Official Colors
$argocd-color-red: #e06c75;
$argocd-color-blue: #61afef;
$argocd-color-green: #98c379;
$argocd-color-yellow: #e5c07b;
$argocd-color-gray: #abb2bf;

// ArgoCD Badge Text Colors
$argocd-badge-text-green: #577e18;
$argocd-badge-text-yellow: #925400;
$argocd-badge-text-red: #bb2a33;
$argocd-badge-text-blue: #0063b8;
$argocd-badge-text-error: white;
$argocd-badge-text-gray: #636363;

// ArgoCD Health Colors
:root {
  --argo-health-healthy: #18be94;
  --argo-health-suspended: #f4c030;
  --argo-health-degraded: #e96d76;
  --argo-health-progressing: #0d84ff;
  --argo-health-missing: #f4c030;
  --argo-health-unknown: #ccd6dd;

  --argo-sync-synced: #18be94;
  --argo-sync-outofsync: #f4c030;
  --argo-sync-unknown: #ccd6dd;

  --argo-sse-connected: #4caf50;
  --argo-sse-connecting: #fbc02d;
  --argo-sse-closed: #e53935;
  --argo-sse-error: #ffffff;
  --argo-sse-retrying: #1976d2;
  --argo-sse-unknown: #bdbdbd;
}

// -----------------------------------------------------------------------------
// Main Layout
// -----------------------------------------------------------------------------

.argocd-application-map {
  // ---------------------------------------------------------------------------
  // Main container for the application map
  // ---------------------------------------------------------------------------
  &__container {
    height: $container-height;
    width: 100%;
    box-sizing: border-box;
    overflow: hidden;

    // ---------------------------------------------------------------------------
    // Graph options panel
    // ---------------------------------------------------------------------------
    & .graph-options-panel {
      z-index: 5;
      margin: 10px 0 0 10px;
    }
  }

  // ---------------------------------------------------------------------------
  // Status Panel
  // ---------------------------------------------------------------------------
  &__status-panel {
    &__title {
      line-height: 19.5px;
      margin-bottom: 3px;

      & label {
        font-size: 12px;
        font-weight: 600;
        .theme-light & {
          color: $color-panel-title;
        }
      }
    }

    // SSE Status Badge Component
    &__sse-status {
      &-badge {
        margin: 5px 5px 0 0;
        border-radius: 20px;
        border: 1px solid;
        display: inline-flex;
        align-items: center;
        font-size: 11px;
        font-weight: 400;
        line-height: 16px;
        padding: 1px 5px 1px 2px;
        cursor: pointer;
        transition: all 0.5s ease-out; // Smooth transition for hover effects
        overflow: hidden;
        max-width: 20px; // Just enough for the icon by default

        &:hover {
          max-width: 300px; // Expand to show text
          padding-right: 8px;
        }

        &--open {
          background-color: color.adjust($argocd-color-green, $lightness: 25%);
          border-color: $argocd-color-green;
          color: $argocd-badge-text-green;
        }

        &--connecting {
          background-color: color.adjust($argocd-color-yellow, $lightness: 25%);
          border-color: $argocd-color-yellow;
          color: $argocd-badge-text-yellow;
        }

        &--closed {
          background-color: color.adjust($argocd-color-red, $lightness: 25%);
          border-color: $argocd-color-red;
          color: $argocd-badge-text-red;
        }

        &--retrying {
          background-color: color.adjust($argocd-color-blue, $lightness: 25%);
          border-color: $argocd-color-blue;
          color: $argocd-badge-text-blue;
        }

        &--error {
          background-color: $argocd-color-red;
          border-color: $argocd-color-red;
          color: $argocd-badge-text-error;
        }

        &--unknown {
          background-color: color.adjust($argocd-color-gray, $lightness: 25%);
          border-color: $argocd-color-gray;
          color: $argocd-badge-text-gray;
        }

        &:hover .sse-status-icon {
          border: 1px solid currentColor; // Show border on hover
        }
      }

      &-text {
        white-space: nowrap;
        opacity: 0;
        transition: opacity 0.25s ease 0.1s; // Slight delay for smoother effect
        overflow: hidden;

        .argocd-application-map__status-panel__sse-status-badge:hover & {
          opacity: 1;
        }
      }
    }

    &__warning {
      &-box {
        margin-top: 8px;
        padding: 8px 12px;
        background-color: $color-warning-bg;
        border-left: 4px solid $color-warning-border;
      }

      &-text {
        font-size: 12px;
        color: $color-warning-text;
      }

      &-header {
        margin-bottom: 4px;
      }

      &-icon {
        margin-right: 6px;
      }

      &-list {
        margin: 4px 0 4px 20px;
        padding: 0;
      }

      &-footer {
        font-size: 11px;
        color: $color-secondary-text;
        margin-top: 4px;
      }
    }
  }

  // ---------------------------------------------------------------------------
  // Node selection states
  // ---------------------------------------------------------------------------
  &__node {
    &--default {
      opacity: 1;
    }
    &--selected {
      opacity: 1;
      position: relative;
    }
    &--unselected {
      opacity: 0.25;
    }
  }

  // ---------------------------------------------------------------------------
  // Edge selection states
  // ---------------------------------------------------------------------------
  &__edge {
    &--default {
      stroke: #777777;
      stroke-width: 1;
      stroke-dasharray: 3, 3;
      stroke-opacity: 1;
    }
    &--selected {
      stroke: #777777;
      stroke-width: 1;
      stroke-dasharray: none;
      stroke-opacity: 1;
    }
    &--unselected {
      stroke: #777777;
      stroke-width: 1;
      stroke-dasharray: 3, 3;
      stroke-opacity: 0.25;
    }
    &__marker {
      &--default {
        opacity: 1;
      }
      &--selected {
        opacity: 1;
      }
      &--unselected {
        opacity: 0.5;
      }
    }
  }
}

.application-resource-tree {
  &__node-kind-icon {
    span.as-icon {
      background: $color-as-icon-bg;
      border-radius: 50%;
      color: white;
      display: inline-block;
      font-size: 1em;
      font-weight: 400;
      height: 32px;
      line-height: 30px;
      padding: 2px 4px;
      text-align: center;
      vertical-align: middle;
      width: 32px;
    }
  }
}

i.utils-health-status-icon {
  min-width: 13px;
  text-align: center;
  margin-right: 4px;
}

.utils-sse-status-icon {
  margin-right: 0;
  vertical-align: middle;
}

.sse-status-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  font-size: 8px;
  margin-right: 4px;
  position: relative;
  // border: 1px solid color-mix(in srgb, currentColor 30%, transparent); // Transparent border by default
  border: 1px solid transparent; // Transparent border by default
  flex-shrink: 0; // Prevent icon from shrinking
  transition: border-color 0.3s ease-out; // Smooth border transition
  // background-color: color-mix(in srgb, currentColor 30%, transparent);

  &:hover {
    border: 1px solid currentColor; // Show border on hover using current text color
  }
}
